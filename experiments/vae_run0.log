Namespace(config='configs/vae_run0.yaml')

------ Parameters ------

exp_name : vae_run0
cuda : True
gpu_device : 0
workers : 2
dir_image : /home/hhg/Research/galaxyClassify/catalog/galaxyZoo_kaggle/gz2_images/images
file_csv : /home/hhg/Research/galaxyClassify/catalog/galaxyZoo/zoo2/gz2_all_v2.csv
label_tag : label_8
num_classes : 8
class_weights : [1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0, 1.0]
f_train : 0.85
f_valid : 0.15
seed : 3
crop_size : 224
input_size : 64
n_channel : 3
n_zlatent : 50
n_filter_E : 64
n_filter_D : 64
num_epochs : 50
batch_size : 64
lr : 0.001
beta1 : 0.5
beta2 : 0.999
step_size : 5
gamma : 0.1
early_stop_threshold : 10
dir_output : /home/hhg/Research/galaxyClassify/repo/GalaxyZooGenerator/experiments
freq_img : 2
Ngals : 9
dpi : 100

------ Prepare Data ------

Number of train galaxies: 132558 (2072 batches)
Number of valid galaxies: 23393 (366 batches)

------ Build Model ------

Number of trainable parameters
Encoder  : 4415876
Decoder  : 3285056

------ Encoder Output Layer Dimensions ------

Input shape:		 torch.Size([1, 3, 64, 64])
Conv2d output shape:	 torch.Size([1, 64, 32, 32])
LeakyReLU output shape:	 torch.Size([1, 64, 32, 32])
Conv2d output shape:	 torch.Size([1, 128, 16, 16])
BatchNorm2d output shape:	 torch.Size([1, 128, 16, 16])
LeakyReLU output shape:	 torch.Size([1, 128, 16, 16])
Conv2d output shape:	 torch.Size([1, 256, 8, 8])
BatchNorm2d output shape:	 torch.Size([1, 256, 8, 8])
LeakyReLU output shape:	 torch.Size([1, 256, 8, 8])
Conv2d output shape:	 torch.Size([1, 512, 4, 4])
BatchNorm2d output shape:	 torch.Size([1, 512, 4, 4])
LeakyReLU output shape:	 torch.Size([1, 512, 4, 4])
Conv2d output shape:	 torch.Size([1, 200, 1, 1])
LeakyReLU output shape:	 torch.Size([1, 200, 1, 1])
Flatten output shape:	 torch.Size([1, 200])
Linear output shape:	 torch.Size([1, 100])

------ Decoder Output Layer Dimensions ------

Input shape:		 torch.Size([1, 50])
Linear output shape:	 torch.Size([1, 64])
Unflatten output shape:	 torch.Size([1, 64, 1, 1])
ConvTranspose2d output shape:	 torch.Size([1, 512, 4, 4])
BatchNorm2d output shape:	 torch.Size([1, 512, 4, 4])
ReLU output shape:	 torch.Size([1, 512, 4, 4])
ConvTranspose2d output shape:	 torch.Size([1, 256, 8, 8])
BatchNorm2d output shape:	 torch.Size([1, 256, 8, 8])
ReLU output shape:	 torch.Size([1, 256, 8, 8])
ConvTranspose2d output shape:	 torch.Size([1, 128, 16, 16])
BatchNorm2d output shape:	 torch.Size([1, 128, 16, 16])
ReLU output shape:	 torch.Size([1, 128, 16, 16])
ConvTranspose2d output shape:	 torch.Size([1, 64, 32, 32])
BatchNorm2d output shape:	 torch.Size([1, 64, 32, 32])
ReLU output shape:	 torch.Size([1, 64, 32, 32])
ConvTranspose2d output shape:	 torch.Size([1, 3, 64, 64])
Sigmoid output shape:	 torch.Size([1, 3, 64, 64])

------ Create experiment directory ------

Training information will be stored at :
 	 /home/hhg/Research/galaxyClassify/repo/GalaxyZooGenerator/experiments/vae_run0

--- Epoch 1/50 ---
		 avg. train  loss : 2748.538
		 avg. valid  loss : 2704.626
	Time: 2m 14s
--- Epoch 2/50 ---
		 avg. train  loss : 2703.639
		 avg. valid  loss : 2697.626
	Time: 2m 17s
--- Epoch 3/50 ---
		 avg. train  loss : 2700.210
		 avg. valid  loss : 2699.050
	Time: 2m 18s
--- Epoch 4/50 ---
		 avg. train  loss : 2698.435
		 avg. valid  loss : 2689.732
	Time: 2m 17s
--- Epoch 5/50 ---
		 avg. train  loss : 2696.832
		 avg. valid  loss : 2687.608
	Time: 2m 17s
--- Epoch 6/50 ---
		 avg. train  loss : 2692.040
		 avg. valid  loss : 2683.582
	Time: 2m 19s
--- Epoch 7/50 ---
		 avg. train  loss : 2691.510
		 avg. valid  loss : 2684.166
	Time: 2m 19s
--- Epoch 8/50 ---
		 avg. train  loss : 2691.132
		 avg. valid  loss : 2683.688
	Time: 2m 19s
--- Epoch 9/50 ---
		 avg. train  loss : 2690.362
		 avg. valid  loss : 2683.337
	Time: 2m 19s
--- Epoch 10/50 ---
		 avg. train  loss : 2690.359
		 avg. valid  loss : 2682.115
	Time: 2m 19s
--- Epoch 11/50 ---
		 avg. train  loss : 2689.775
		 avg. valid  loss : 2683.228
	Time: 2m 12s
--- Epoch 12/50 ---
		 avg. train  loss : 2689.696
		 avg. valid  loss : 2682.897
	Time: 2m 12s
--- Epoch 13/50 ---
		 avg. train  loss : 2690.147
		 avg. valid  loss : 2681.397
	Time: 2m 12s
--- Epoch 14/50 ---
		 avg. train  loss : 2689.838
		 avg. valid  loss : 2682.345
	Time: 2m 18s
--- Epoch 15/50 ---
		 avg. train  loss : 2689.962
		 avg. valid  loss : 2683.046
	Time: 2m 11s
--- Epoch 16/50 ---
		 avg. train  loss : 2689.434
		 avg. valid  loss : 2682.015
	Time: 2m 16s
--- Epoch 17/50 ---
		 avg. train  loss : 2689.735
		 avg. valid  loss : 2682.332
	Time: 2m 11s
--- Epoch 18/50 ---
		 avg. train  loss : 2689.513
		 avg. valid  loss : 2681.531
	Time: 2m 11s
--- Epoch 19/50 ---
		 avg. train  loss : 2689.189
		 avg. valid  loss : 2682.599
	Time: 2m 12s
--- Epoch 20/50 ---
		 avg. train  loss : 2689.772
		 avg. valid  loss : 2681.749
	Time: 2m 17s
--- Epoch 21/50 ---
		 avg. train  loss : 2689.284
		 avg. valid  loss : 2682.196
	Time: 2m 12s
--- Epoch 22/50 ---
		 avg. train  loss : 2689.738
		 avg. valid  loss : 2681.596
	Time: 2m 12s
--- Epoch 23/50 ---
		 avg. train  loss : 2690.044
		 avg. valid  loss : 2682.800
	Time: 2m 12s
Early stopping... (Model did not imporve after 10 epochs)
Minimum validation loss 2681.3965125117556 reached at epoch 13
